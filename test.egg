$MD::AiIdle = 0;
$MD::AiSeek = 1;
$MD::AiAttack = 2;

function AiPlayer::onSpawn(%this, %roomIndex) {
	%this.spawnTime = getSimTime();
}

function AiPlayer::setAiState(%this, %state) {
	%this.ai = %this.schedule(33, _setAIState, %state);
}

function AiPlayer::_setAiState(%this, %state) {
	if(isObject(%this.ai)) {
		%this.ai.delete(); // handling wait schedule
	}
	else {
		cancel(%this.ai);
	}
	
	// cleanup
	if(%this.state != %state) {
		switch(%this.state) {
			case 0:
				%this.call(%this.idleCleanup, %state);
			
			case 1:
				%this.call(%this.seekCleanup, %state);
			
			case 2:
				%this.call(%this.attackCleanup, %state);
			
			default:
				talk("howdy");
		}
	}
	
	switch(%state) {
		case 0:
			%this.call(%this.idle);

		case 1:
			%this.call(%this.seek);
		
		case 2:
			%this.call(%this.attack);
	}
	%this.state = %state;
}